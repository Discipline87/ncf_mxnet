nohup: ignoring input
INFO:root:Namespace(batch_size=99000, beta1=0.783529, beta2=0.909003, dataset='ml-20m', eps=1.45439e-07, factor_size_gmf=64, gpus='0', layers='[256, 128, 64]', learning_rate=0.00382059, log_interval=100, model_type='neumf', num_epoch=10, num_hidden=1, num_neg=4, num_valid=1000, path='./data/', seed=1, sparse=False)
[15:01:51] src/base.cc:51: Upgrade advisory: this mxnet has been built against cuda library version 9000, which is older than the oldest version tested by CI (10000).  Set MXNET_CUDA_LIB_CHECKING=0 to quiet this warning.
INFO:root:Training started ...
INFO:root:Epoch[0] Batch [0-100]	Speed: 79403.78 samples/sec	cross_entropy=25225.207031
INFO:root:Epoch[0] Batch [100-200]	Speed: 75739.11 samples/sec	cross_entropy=19135.804688
INFO:root:Epoch[0] Batch [200-300]	Speed: 75392.33 samples/sec	cross_entropy=17392.337891
INFO:root:Epoch[0] Batch [300-400]	Speed: 73386.58 samples/sec	cross_entropy=16278.326172
INFO:root:Epoch[0] Batch [400-500]	Speed: 75574.54 samples/sec	cross_entropy=15552.040039
INFO:root:Epoch[0] Batch [500-600]	Speed: 75392.26 samples/sec	cross_entropy=15109.577148
INFO:root:Epoch[0] Batch [600-700]	Speed: 75370.60 samples/sec	cross_entropy=14757.842773
INFO:root:Epoch[0] Batch [700-800]	Speed: 75425.81 samples/sec	cross_entropy=14384.290039
INFO:root:Epoch[0] Batch [800-900]	Speed: 74997.32 samples/sec	cross_entropy=13967.412109
INFO:root:Epoch[0] Batch [900-1000]	Speed: 75291.33 samples/sec	cross_entropy=13618.259766
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0000.params"
INFO:root:Iteration 0: HR = 0.4290, NDCG = 0.2227
INFO:root:Epoch[1] Batch [0-100]	Speed: 75915.75 samples/sec	cross_entropy=12814.151367
INFO:root:Epoch[1] Batch [100-200]	Speed: 75321.48 samples/sec	cross_entropy=12736.474609
INFO:root:Epoch[1] Batch [200-300]	Speed: 75126.06 samples/sec	cross_entropy=12631.878906
INFO:root:Epoch[1] Batch [300-400]	Speed: 74973.16 samples/sec	cross_entropy=12479.886719
INFO:root:Epoch[1] Batch [400-500]	Speed: 74613.20 samples/sec	cross_entropy=12318.445312
INFO:root:Epoch[1] Batch [500-600]	Speed: 72411.81 samples/sec	cross_entropy=12219.110352
INFO:root:Epoch[1] Batch [600-700]	Speed: 64421.69 samples/sec	cross_entropy=12107.276367
INFO:root:Epoch[1] Batch [700-800]	Speed: 64545.21 samples/sec	cross_entropy=11983.302734
INFO:root:Epoch[1] Batch [800-900]	Speed: 64468.96 samples/sec	cross_entropy=11907.660156
INFO:root:Epoch[1] Batch [900-1000]	Speed: 64465.94 samples/sec	cross_entropy=11798.094727
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0001.params"
INFO:root:Iteration 1: HR = 0.4800, NDCG = 0.2419
INFO:root:Epoch[2] Batch [0-100]	Speed: 77168.01 samples/sec	cross_entropy=10481.872070
INFO:root:Epoch[2] Batch [100-200]	Speed: 77176.50 samples/sec	cross_entropy=10546.048828
INFO:root:Epoch[2] Batch [200-300]	Speed: 77649.11 samples/sec	cross_entropy=10594.762695
INFO:root:Epoch[2] Batch [300-400]	Speed: 78401.80 samples/sec	cross_entropy=10638.397461
INFO:root:Epoch[2] Batch [400-500]	Speed: 78073.20 samples/sec	cross_entropy=10634.750977
INFO:root:Epoch[2] Batch [500-600]	Speed: 77551.47 samples/sec	cross_entropy=10649.798828
INFO:root:Epoch[2] Batch [600-700]	Speed: 77528.24 samples/sec	cross_entropy=10667.761719
INFO:root:Epoch[2] Batch [700-800]	Speed: 78149.00 samples/sec	cross_entropy=10677.382812
INFO:root:Epoch[2] Batch [800-900]	Speed: 78514.12 samples/sec	cross_entropy=10684.937500
INFO:root:Epoch[2] Batch [900-1000]	Speed: 77640.13 samples/sec	cross_entropy=10682.449219
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0002.params"
INFO:root:Iteration 2: HR = 0.4820, NDCG = 0.2411
INFO:root:Epoch[3] Batch [0-100]	Speed: 78258.47 samples/sec	cross_entropy=8766.322266
INFO:root:Epoch[3] Batch [100-200]	Speed: 78478.40 samples/sec	cross_entropy=8924.455078
INFO:root:Epoch[3] Batch [200-300]	Speed: 78467.81 samples/sec	cross_entropy=9109.737305
INFO:root:Epoch[3] Batch [300-400]	Speed: 78435.98 samples/sec	cross_entropy=9256.356445
INFO:root:Epoch[3] Batch [400-500]	Speed: 77858.86 samples/sec	cross_entropy=9410.752930
INFO:root:Epoch[3] Batch [500-600]	Speed: 78188.21 samples/sec	cross_entropy=9480.358398
INFO:root:Epoch[3] Batch [600-700]	Speed: 77847.22 samples/sec	cross_entropy=9574.075195
INFO:root:Epoch[3] Batch [700-800]	Speed: 77909.20 samples/sec	cross_entropy=9637.234375
INFO:root:Epoch[3] Batch [800-900]	Speed: 78184.19 samples/sec	cross_entropy=9710.428711
INFO:root:Epoch[3] Batch [900-1000]	Speed: 78111.20 samples/sec	cross_entropy=9766.857422
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0003.params"
INFO:root:Iteration 3: HR = 0.4770, NDCG = 0.2401
INFO:root:Epoch[4] Batch [0-100]	Speed: 78921.38 samples/sec	cross_entropy=7769.225098
INFO:root:Epoch[4] Batch [100-200]	Speed: 78223.53 samples/sec	cross_entropy=7993.332031
INFO:root:Epoch[4] Batch [200-300]	Speed: 78352.73 samples/sec	cross_entropy=8210.704102
INFO:root:Epoch[4] Batch [300-400]	Speed: 78344.84 samples/sec	cross_entropy=8421.285156
INFO:root:Epoch[4] Batch [400-500]	Speed: 78570.46 samples/sec	cross_entropy=8581.961914
INFO:root:Epoch[4] Batch [500-600]	Speed: 78083.97 samples/sec	cross_entropy=8722.252930
INFO:root:Epoch[4] Batch [600-700]	Speed: 77744.19 samples/sec	cross_entropy=8794.976562
INFO:root:Epoch[4] Batch [700-800]	Speed: 77004.22 samples/sec	cross_entropy=8923.652344
INFO:root:Epoch[4] Batch [800-900]	Speed: 78027.33 samples/sec	cross_entropy=9006.994141
INFO:root:Epoch[4] Batch [900-1000]	Speed: 78470.20 samples/sec	cross_entropy=9064.727539
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0004.params"
INFO:root:Iteration 4: HR = 0.4960, NDCG = 0.2466
INFO:root:Epoch[5] Batch [0-100]	Speed: 78810.39 samples/sec	cross_entropy=7140.421875
INFO:root:Epoch[5] Batch [100-200]	Speed: 76431.05 samples/sec	cross_entropy=7362.311035
INFO:root:Epoch[5] Batch [200-300]	Speed: 77302.32 samples/sec	cross_entropy=7613.593262
INFO:root:Epoch[5] Batch [300-400]	Speed: 76847.75 samples/sec	cross_entropy=7809.226074
INFO:root:Epoch[5] Batch [400-500]	Speed: 76535.12 samples/sec	cross_entropy=7984.024902
INFO:root:Epoch[5] Batch [500-600]	Speed: 77740.01 samples/sec	cross_entropy=8144.376953
INFO:root:Epoch[5] Batch [600-700]	Speed: 76790.50 samples/sec	cross_entropy=8269.253906
INFO:root:Epoch[5] Batch [700-800]	Speed: 78180.50 samples/sec	cross_entropy=8389.888672
INFO:root:Epoch[5] Batch [800-900]	Speed: 77634.86 samples/sec	cross_entropy=8470.684570
INFO:root:Epoch[5] Batch [900-1000]	Speed: 76505.00 samples/sec	cross_entropy=8547.262695
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0005.params"
INFO:root:Iteration 5: HR = 0.4800, NDCG = 0.2351
INFO:root:Epoch[6] Batch [0-100]	Speed: 77312.87 samples/sec	cross_entropy=6660.314941
INFO:root:Epoch[6] Batch [100-200]	Speed: 77879.75 samples/sec	cross_entropy=6909.344238
INFO:root:Epoch[6] Batch [200-300]	Speed: 78178.04 samples/sec	cross_entropy=7140.323730
INFO:root:Epoch[6] Batch [300-400]	Speed: 78211.73 samples/sec	cross_entropy=7377.673828
INFO:root:Epoch[6] Batch [400-500]	Speed: 78279.53 samples/sec	cross_entropy=7554.079590
INFO:root:Epoch[6] Batch [500-600]	Speed: 78239.78 samples/sec	cross_entropy=7666.546875
INFO:root:Epoch[6] Batch [600-700]	Speed: 77989.87 samples/sec	cross_entropy=7815.512695
INFO:root:Epoch[6] Batch [700-800]	Speed: 77498.68 samples/sec	cross_entropy=7935.276855
INFO:root:Epoch[6] Batch [800-900]	Speed: 77619.99 samples/sec	cross_entropy=8009.313965
INFO:root:Epoch[6] Batch [900-1000]	Speed: 77399.09 samples/sec	cross_entropy=8106.020508
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0006.params"
INFO:root:Iteration 6: HR = 0.4670, NDCG = 0.2332
INFO:root:Epoch[7] Batch [0-100]	Speed: 79095.54 samples/sec	cross_entropy=6298.355469
INFO:root:Epoch[7] Batch [100-200]	Speed: 77991.51 samples/sec	cross_entropy=6537.689941
INFO:root:Epoch[7] Batch [200-300]	Speed: 76428.20 samples/sec	cross_entropy=6775.621094
INFO:root:Epoch[7] Batch [300-400]	Speed: 75845.91 samples/sec	cross_entropy=6957.912598
INFO:root:Epoch[7] Batch [400-500]	Speed: 77535.19 samples/sec	cross_entropy=7156.329590
INFO:root:Epoch[7] Batch [500-600]	Speed: 76742.74 samples/sec	cross_entropy=7289.147949
INFO:root:Epoch[7] Batch [600-700]	Speed: 77204.93 samples/sec	cross_entropy=7427.818359
INFO:root:Epoch[7] Batch [700-800]	Speed: 76143.03 samples/sec	cross_entropy=7542.525391
INFO:root:Epoch[7] Batch [800-900]	Speed: 77627.80 samples/sec	cross_entropy=7647.356445
INFO:root:Epoch[7] Batch [900-1000]	Speed: 76043.98 samples/sec	cross_entropy=7743.551758
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0007.params"
INFO:root:Iteration 7: HR = 0.4650, NDCG = 0.2284
INFO:root:Epoch[8] Batch [0-100]	Speed: 79409.37 samples/sec	cross_entropy=5972.807617
INFO:root:Epoch[8] Batch [100-200]	Speed: 78650.30 samples/sec	cross_entropy=6235.705078
INFO:root:Epoch[8] Batch [200-300]	Speed: 78632.21 samples/sec	cross_entropy=6442.518555
INFO:root:Epoch[8] Batch [300-400]	Speed: 76578.35 samples/sec	cross_entropy=6650.979492
INFO:root:Epoch[8] Batch [400-500]	Speed: 77609.83 samples/sec	cross_entropy=6815.587891
INFO:root:Epoch[8] Batch [500-600]	Speed: 76385.76 samples/sec	cross_entropy=6955.781738
INFO:root:Epoch[8] Batch [600-700]	Speed: 75911.80 samples/sec	cross_entropy=7079.451172
INFO:root:Epoch[8] Batch [700-800]	Speed: 76932.82 samples/sec	cross_entropy=7200.466797
INFO:root:Epoch[8] Batch [800-900]	Speed: 76442.65 samples/sec	cross_entropy=7303.504883
INFO:root:Epoch[8] Batch [900-1000]	Speed: 77119.68 samples/sec	cross_entropy=7413.556152
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0008.params"
INFO:root:Iteration 8: HR = 0.4660, NDCG = 0.2307
INFO:root:Epoch[9] Batch [0-100]	Speed: 78586.86 samples/sec	cross_entropy=5698.162109
INFO:root:Epoch[9] Batch [100-200]	Speed: 78711.48 samples/sec	cross_entropy=5939.736328
INFO:root:Epoch[9] Batch [200-300]	Speed: 78524.77 samples/sec	cross_entropy=6172.172363
INFO:root:Epoch[9] Batch [300-400]	Speed: 77605.67 samples/sec	cross_entropy=6371.357910
INFO:root:Epoch[9] Batch [400-500]	Speed: 77833.12 samples/sec	cross_entropy=6533.727539
INFO:root:Epoch[9] Batch [500-600]	Speed: 78130.60 samples/sec	cross_entropy=6661.638184
INFO:root:Epoch[9] Batch [600-700]	Speed: 77907.02 samples/sec	cross_entropy=6780.529297
INFO:root:Epoch[9] Batch [700-800]	Speed: 75859.16 samples/sec	cross_entropy=6895.283203
INFO:root:Epoch[9] Batch [800-900]	Speed: 78018.37 samples/sec	cross_entropy=7022.426270
INFO:root:Epoch[9] Batch [900-1000]	Speed: 77153.58 samples/sec	cross_entropy=7089.198242
INFO:root:Saved checkpoint to "/home/yingguo/ncf_mxnet_data/model/ml-20m/neumf-0009.params"
INFO:root:Iteration 9: HR = 0.4640, NDCG = 0.2319
INFO:root:End. Best Iteration 4:  HR = 0.4960, NDCG = 0.2466. 
INFO:root:Training completed.
Load data done. #user=138493, #item=26744, #train=19861770, #test=138493
